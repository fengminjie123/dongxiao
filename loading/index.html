<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
		<title>canvas loading</title>
	</head>
	<body>
		<div id="app">
			<template>
				<div class="container">
					<canvas id="canvas" width="450" height="450"></canvas>
				</div>
			</template>
		</div>
		<script>
			var app = new Vue({
				el: '#app',
				data: {
					curValue: 0,
					speed: 1,
					r: 80,
					w1: null,
					w2: null,
					fi: 0
				},
				mounted () {
					// 周期 T  3 * r / 2  w = 2 * Math.PI / T
					this.w1 = 4 * Math.PI / 3 * this.r
					this.w2 = -4 * Math.PI / 3 * this.r
					// setInterval(() => {
					// 	this.addFn()
					// }, 500)
				},
				methods: {
					addFn() { // 增加方法
						this.curValue += this.speed
						if (this.curValue > 100) {
							this.curValue = 100
						}
						// 制作波浪
						this.drawWaveFn(6, this.w1, this.fi, 'rgba(34, 167, 250, .9)')
						this.drawWaveFn(8, this.w1, this.fi, 'rgba(0, 0, 255, .5)')
						// 书写文字
					},
					drawWaveFn(a, w, fi, color) { // 画波浪
						var canvas = document.getElementById('canvas')
						var ctx = canvas.getContext('2d')
						ctx.beginPath();
						sx = canvas.width / 2 - this.r
						sy = canvas.height / 2 + this.r
						console.log('46', sx, sy)
						ctx.moveTo(sx,sy)
						ctx.lineTo(sx, sy - this.curValue / 100 * 2 * this. r) // sy - this.curValue * 100 * 2 * this. r 最大值 减去当前进度的距离
						for (let i = 0; i < 2 * this.r ; ++i) {
							x = sx + i
							y = a * Math.sin(w * i + this.fi) + sy - this.curValue / 100 * 2 * this.r
							ctx.lineTo(x, y) // sy - this.curValue * 100 * 2 * this. r 最大值 减去当前进度的距离
						}
						ctx.lineTo(sx+2*R,sy);
						ctx.closePath();
						ctx.fill();
					}
				}
			})
		</script>
	</body>
	<style>
		body{
			margin: 0;
		}
		#app {
			width: 100vw;
			height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		.container {
			width: 700px;
			height: 500px;
			background-color: rgba(0, 0, 0, .1);
			border-radius: 10px;
			position: relative;
		}
		#canvas {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}
	</style>
</html>